(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/post-detail/post-detail"],{"0b8d":function(t,e,n){"use strict";n.r(e);var o=n("fa90"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},6280:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={postList:function(){return n.e("components/post-list/post-list").then(n.bind(null,"94df"))},commentPopup:function(){return n.e("components/comment-popup/comment-popup").then(n.bind(null,"6803"))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.comments,(function(e,n){var o=t.__get_orig(e),r=t._f("formatTime")(e.created_time),i=e.post_comments&&e.post_comments.length>0?t.__map(e.post_comments,(function(e,n){var o=t.__get_orig(e),r=t._f("formatTime")(e.created_time);return{$orig:o,f1:r}})):null;return{$orig:o,f0:r,l0:i}})));t.$mp.data=Object.assign({},{$root:{l1:n}})},i=[]},a7cb:function(t,e,n){},cbff:function(t,e,n){"use strict";var o=n("a7cb"),r=n.n(o);r.a},f2e1:function(t,e,n){"use strict";n.r(e);var o=n("6280"),r=n("0b8d");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("cbff");var s,a=n("f0c5"),u=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);e["default"]=u.exports},f75b:function(t,e,n){"use strict";(function(t){n("90f6");o(n("66fd"));var e=o(n("f2e1"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},fa90:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("c9eb"));function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return c(t)||u(t)||a(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"===typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function u(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function c(t){if(Array.isArray(t))return m(t)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var l={filters:{formatTime:function(t){return o.default.getHumanTime(t)}},data:function(){return{detail:{id:0,content:[],user_id:0,comment_count:0,support_count:0,is_top:0,created_time:"",user:{id:0,avatar:"",sex:"未知",name:""},issupport:!1},page:1,comments:[],loadStatus:"more",commentForm:{reply_id:0,reply_user:null}}},onLoad:function(e){var n=this;if(!e.id)return this.$toast("非法参数"),t.navigateBack({delta:1});this.detail.id=e.id,this.$api.readPost({id:e.id}).then((function(t){n.detail=t,console.log(n.detail)})),this.getCommentList()},methods:{sendComment:function(e){var n=this,o={post_id:this.detail.id,content:e,reply_id:0};this.commentForm.reply_user&&(o.reply_id=this.commentForm.reply_id,o.reply_user=this.commentForm.reply_user),this.$api.replyPost(o).then((function(e){n.$toast("评论成功"),n.page=1,n.getCommentList(),t.$emit("refreshBbs")}))},openComment:function(t){t?(this.commentForm.reply_id=t.reply_id,this.commentForm.reply_user=t.reply_user,this.commentForm.reply_user.username=t.reply_user.name):this.commentForm={reply_id:0,reply_user:null},this.$refs.comment.open()},handleSupport:function(){var e=this,n=this.detail,o=n.issupport?"unsupportPost":"supportPost",r=n.issupport?"取消点赞":"点赞成功";this.$api[o]({post_id:n.id}).then((function(o){n.support_count=n.issupport?n.support_count-1:n.support_count+1,n.issupport=!n.issupport,e.$toast(r),t.$emit("refreshBbs")}))},loadMore:function(){"more"==this.loadStatus&&(this.page=this.page+1,this.getCommentList())},getCommentList:function(){var t=this;this.loadStatus="loading",this.$api.getPostComments({post_id:this.detail.id,page:this.page}).then((function(e){var n=e.rows;t.comments=1==t.page?n:[].concat(i(t.comments),i(n)),t.loadStatus=n.length<10?"noMore":"more",console.log(t.comments)})).catch((function(e){t.loadStatus="more",t.page>1&&(t.page=t.page-1)}))}}};e.default=l}).call(this,n("543d")["default"])}},[["f75b","common/runtime","common/vendor"]]]);