(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bbs/bbs"],{"24c1":function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"c",(function(){return s})),e.d(n,"a",(function(){return o}));var o={uniLoadMore:function(){return e.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more").then(e.bind(null,"7a25"))},postList:function(){return e.e("components/post-list/post-list").then(e.bind(null,"94df"))}},r=function(){var t=this,n=t.$createElement;t._self._c},s=[]},2604:function(t,n,e){"use strict";e.r(n);var o=e("24c1"),r=e("d2cf");for(var s in r)"default"!==s&&function(t){e.d(n,t,(function(){return r[t]}))}(s);var i,a=e("f0c5"),u=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);n["default"]=u.exports},"9efa":function(t,n,e){"use strict";(function(t){e("90f6");o(e("66fd"));var n=o(e("2604"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},a13c:function(t,n,e){"use strict";(function(t){function e(t){return i(t)||s(t)||r(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,n){if(t){if("string"===typeof t)return a(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,n):void 0}}function s(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function i(t){if(Array.isArray(t))return a(t)}function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var u={data:function(){return{userCount:0,postCount:0,bbsLoadStatus:"loading",activeIndex:0,bbs:[],bbsQuery:{page:1},listQuery:{page:1,keyword:"",bbs_id:0},list:[],loadStatus:"loading"}},onLoad:function(){this.getBbs(),this.getData(),t.$on("refreshBbs",this.refresh)},beforeDestroy:function(){t.$off("refreshBbs",this.refresh)},onPullDownRefresh:function(){this.refresh()},onReachBottom:function(){this.handleLoadMore()},onNavigationBarSearchInputConfirmed:function(t){this.listQuery.keyword=t.text,this.refresh()},onNavigationBarButtonTap:function(){t.navigateTo({url:"../add-post/add-post"})},methods:{handleSupport:function(t){var n=this,e=this.list.find((function(n){return n.id==t}));if(e){var o=e.issupport?"unsupportPost":"supportPost",r=e.issupport?"取消点赞":"点赞成功";this.$api[o]({post_id:e.id}).then((function(t){e.support_count=e.issupport?e.support_count-1:e.support_count+1,e.issupport=!e.issupport,n.$toast(r)}))}},refresh:function(){this.listQuery.page=1,this.getData().finally((function(){t.stopPullDownRefresh()}))},changeBbs:function(t){this.activeIndex!=t&&(this.activeIndex=t,this.listQuery.bbs_id=this.bbs[t].id,this.listQuery.page=1,this.list=[],this.getData())},getData:function(){var t=this;this.loadStatus="loading";var n=this.listQuery.page;return this.$api.getPostList(this.listQuery).then((function(o){t.list=1==n?o.rows:[].concat(e(t.list),e(o.rows)),t.loadStatus=o.rows.length<10?"noMore":"more"})).catch((function(n){t.loadStatus="more",t.listQuery.page>1&&(t.listQuery.page-=1)}))},handleLoadMore:function(){"more"==this.loadStatus&&(this.listQuery.page++,this.getData())},handleBbsLoadMore:function(){"more"==this.bbsLoadStatus&&(this.bbsQuery.page++,this.getBbs())},getBbs:function(){var t=this;this.bbsLoadStatus="loading",this.$api.getBbsList(this.bbsQuery).then((function(n){t.postCount=n.postCount,t.userCount=n.userCount;var o=1==t.bbsQuery.page?n.rows:[].concat(e(t.bbs),e(n.rows));1==t.bbsQuery.page&&o.unshift({id:0,title:"全部"}),t.bbs=o,t.bbsLoadStatus=n.rows.length<10?"noMore":"more"})).catch((function(n){t.bbsLoadStatus="more",t.bbsQuery.page>1&&(t.bbsQuery.page-=1)}))}}};n.default=u}).call(this,e("543d")["default"])},d2cf:function(t,n,e){"use strict";e.r(n);var o=e("a13c"),r=e.n(o);for(var s in o)"default"!==s&&function(t){e.d(n,t,(function(){return o[t]}))}(s);n["default"]=r.a}},[["9efa","common/runtime","common/vendor"]]]);